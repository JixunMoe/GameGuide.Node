extends layout

block content
  - function active_chapter(c) { return c.active ? 'active' : '' };
  header
    h1 #{guide.name}
      .visible-xs-block
      small 攻略作者：
        a(href="/user/" + guide.User.name)
          =guide.User.name
      .visible-xs-block
      small
        span 游戏：
        a(href='/game/' + guide.Game.url)
          =guide.Game.name
      if session.user && session.user.id == guide.UserId
        .visible-xs-block
        small
          a(href="/edit/guide/" + guide.id) 编辑


  main#guide.guide.render(
    data-chapter=chapter.url,
    render="guide"
  )
    section.col-xs-12.col-md-3
      h2 章节列表
      ul.list-group.chapters
        each chap in chapters
          if chap.dataValues.is_header == "1"
            .list-group-item.list-group-item-success.chapter-header
              h4= chap.name
          else
            a.chapter.list-group-item(
              class=active_chapter(chap),
              href='/guide/' + guide.url + '/' + chap.url,
              data-url=chap.url,
              data-id=chap.id
            ) #{chap.name}

    section#chapter.col-xs-12.col-md-9
      h2.title= chapter.name.trim()
      div.content!=marked(chapter.content)

block title
  = guide.name + " - 游戏攻略"

block require
  // script(src="/javascripts/guide.js")